---
title:  "代理和反向代理"
date:   2018-12-19 07:08:11 +0800
tags: System Fav
---

和小伙伴们闲聊，代理forward proxy和反向代理reverse proxy

## 以借钱为案例比喻 
假设我是某个童话王国的商人，做生意需要更多资金，但是对贷款业务不熟悉，于是找个中间人帮忙跑腿。去a银行借点，b富豪借点。  
这个人，我们先称为**代理**。

然后，在去找c银行的时候，行长说：由于风控（国家政策经济形势……），现在我们对小额贷款收缩了，办不了你这个。你要想，那我介绍一个朋友给你认识吧，他有路子。  
懂事的你自然明白：**这个人实际上也是从这个银行借钱出来，再借钱给你**。  
但是银行不直接跟你玩，他指定了这个人做他的代理人，你只能跟这个人玩。  
这个人就是银行的代理，我们暂时称他为**反向代理**。

## 从这个故事来解析
+ 发起者，使用中介，到达目的地，这个就是forward proxy
+ 目的地，把自己隐藏起来，让别人只能通过那个中介找到他，这个就是reverse proxy

## 反向代理的第一特征
**对于发起者来说，这个中介是不是完全“代表”了目的地，把目的地隐藏起来了，是关键差别一**。

reverse proxy不一定是目的地自己设立和控制的。     
举例来说，童话故事里因为贷款太麻烦，存款利息又低，民间出了个公司，可以存款+借贷。对于大家来说，存款利息高了，贷款利息低了，手续还特别方便。大家各自窃喜。  
然后天降灵符，说这个不安全，上天有好生之德，将其管理起来。  
这个管理，就不是被管理对象设立和控制的。他隐藏并代表了被管理对象，因此是reverse proxy 。

## 反向代理的第二特征
**他可能会修改请求和答复**  
还是以借钱为例，如果是我们找到的代理，他一般要手续费。  
但是如果是反向代理，很可能就变成这样了，借100w，到手80w，要还130w；银行那边放贷120w（收回来130w，利息8%，符合他们的业务规则）。  
反向代理俩头都骗，对客户端冒充服务器端，对服务器端冒充客户端。

## 用it案例来说
+ 由于某个不能说的秘密，大家不能访问不了技术网站，通过“代理”来访问。
+ 我们架设了一个服务器，前面放一个nginx，作为“反向代理”
+ 公司不想大家看新闻，全部封闭了，但是又希望大家能看技术站点，在局域网内放一个nginx作为“反向代理”，访问它的80端口是csdn，81是javaeye
+ 手机调试，走charless，不仅可以看见请求和答复，还可以修改，这个是反向代理。